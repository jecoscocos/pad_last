
{% extends 'base.html' %}
{% block title %}–û–±—ä–µ–∫—Ç—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏{% endblock %}
{% block content %}
{% if current_user.is_authenticated and current_user.role == 'agent' %}
<section class="card" style="margin-bottom:2rem;">
   <h2 style="margin-bottom:1rem;">–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç</h2>
   <a class="button" href="{{ url_for('new_property') }}">‚ûï –ù–æ–≤—ã–π –æ–±—ä–µ–∫—Ç</a>
</section>
{% endif %}

<section class="card" style="background: var(--secondary);">
   <h2 style="margin-bottom:2rem;">–ö–∞—Ç–∞–ª–æ–≥ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</h2>
   {% if properties %}
   <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(340px,1fr)); gap:2rem;">
	   {% for p in properties %}
	   <div class="property-card" style="background:white; border-radius:16px; box-shadow:0 4px 24px rgba(0,0,0,0.08); overflow:hidden; display:flex; flex-direction:column;">
		   {% if p.photos and p.photos|length > 0 %}
			   <a href="{{ url_for('property_detail', property_id=p.id) }}">
				   <img src="{{ url_for('uploaded_file', filename=p.photos[0].file_path) }}" alt="–§–æ—Ç–æ –æ–±—ä–µ–∫—Ç–∞" style="width:100%; height:220px; object-fit:cover;">
			   </a>
		   {% else %}
			   <div style="width:100%; height:220px; background:#f3f4f6; display:flex; align-items:center; justify-content:center; color:#bbb; font-size:4rem;">
				   üè†
			   </div>
		   {% endif %}
		   <div style="padding:1.5rem; flex:1; display:flex; flex-direction:column;">
			   <h3 style="margin-bottom:0.5rem; font-size:1.3rem; color:var(--primary);">
				   <a href="{{ url_for('property_detail', property_id=p.id) }}" style="text-decoration:none; color:inherit;">{{ p.title }}</a>
			   </h3>
			   <div style="color:var(--text-muted); margin-bottom:0.5rem;">
				   {{ p.city }}, {{ p.address }}
			   </div>
			   <div style="font-size:1.2rem; font-weight:600; color:var(--accent); margin-bottom:0.5rem;">
				   {{ '%.0f' % p.price_eur }} ‚Ç¨
			   </div>
			   <div style="margin-bottom:0.5rem;">
				   <span style="background:var(--primary); color:white; padding:0.3rem 0.8rem; border-radius:12px; font-size:0.9rem; margin-right:0.5rem;">{{ p.property_type }}</span>
				   {% if p.area_m2 %}<span style="color:var(--text-muted);">üìê {{ '%.1f' % p.area_m2 }} –º¬≤</span>{% endif %}
				   {% if p.rooms %}<span style="color:var(--text-muted); margin-left:0.5rem;">üõèÔ∏è {{ p.rooms }} –∫–æ–º–Ω.</span>{% endif %}
			   </div>
			   <div style="margin-bottom:0.5rem;">
				   {% if p.is_for_sale %}<span style="background:var(--accent); color:white; padding:0.3rem 0.8rem; border-radius:12px; font-size:0.9rem; margin-right:0.5rem;">–ü—Ä–æ–¥–∞–∂–∞</span>{% endif %}
				   {% if p.is_for_rent %}<span style="background:var(--primary-dark); color:white; padding:0.3rem 0.8rem; border-radius:12px; font-size:0.9rem;">–ê—Ä–µ–Ω–¥–∞</span>{% endif %}
			   </div>
			   {% if p.description %}
			   <div style="color:var(--text-muted); font-size:0.95rem; margin-bottom:0.5rem;">{{ p.description[:80] }}{% if p.description|length > 80 %}...{% endif %}</div>
			   {% endif %}
			   <a href="{{ url_for('property_detail', property_id=p.id) }}" class="button" style="margin-top:auto;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
		   </div>
	   </div>
	   {% endfor %}
   </div>
   {% else %}
	   <p class="muted">–ü–æ–∫–∞ –Ω–µ—Ç –æ–±—ä–µ–∫—Ç–æ–≤.</p>
   {% endif %}
</section>
{% endblock %}

