<!doctype html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>{% block title %}–ê–≥–µ–Ω—Ç—Å—Ç–≤–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏{% endblock %}</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
	<header class="container nav">
		<h1><a href="{{ url_for('index') }}">üè† –ê–≥–µ–Ω—Ç—Å—Ç–≤–æ</a></h1>
		<nav style="display: flex; gap: 0.75rem; align-items: center; flex-wrap: wrap;">
			   {% if current_user.is_authenticated %}
		   <a href="{{ url_for('index') }}">–û–±—ä–µ–∫—Ç—ã</a>
		   {% if current_user.role == 'agent' %}
			   <a href="{{ url_for('new_property') }}">–î–æ–±–∞–≤–∏—Ç—å</a>
			   <a href="{{ url_for('all_inquiries') }}">–ó–∞—è–≤–∫–∏</a>
			   <a href="{{ url_for('appointments') }}">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</a>
			   <a href="{{ url_for('analytics') }}">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
			   <a href="{{ url_for('reports') }}">–û—Ç—á—ë—Ç—ã</a>
		   {% endif %}
				   {% if current_user.role == 'user' or current_user.role == 'admin' %}
					   <a href="{{ url_for('my_inquiries') }}">–ú–æ–∏ –∑–∞—è–≤–∫–∏</a>
				   {% endif %}
				   <a href="{{ url_for('list_notifications') }}">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</a>
				   <a href="{{ url_for('my_payments') }}">–ü–ª–∞—Ç–µ–∂–∏</a>
				   <span class="muted" style="font-size: 0.85rem;">{{ current_user.email }}</span>
				   <a href="{{ url_for('logout') }}" style="background: rgba(239, 68, 68, 0.1); color: #dc2626;">–í—ã–π—Ç–∏</a>
			   {% else %}
				   <a href="{{ url_for('login') }}">–í–æ–π—Ç–∏</a>
				   <a href="{{ url_for('register') }}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
			   {% endif %}
		</nav>
	</header>
	<main class="container">
		{% with messages = get_flashed_messages(with_categories=true) %}
			{% if messages %}
				{% for category, message in messages %}
					<div class="alert alert-{{ category }}">{{ message }}</div>
				{% endfor %}
			{% endif %}
		{% endwith %}
		{% block content %}{% endblock %}
	</main>
	<footer style="text-align: center; padding: 2rem 0; color: rgba(255, 255, 255, 0.7); margin-top: 4rem;">
		<small>üè† –ê–≥–µ–Ω—Ç—Å—Ç–≤–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ú–æ–ª–¥–æ–≤—ã ‚Ä¢ Flask ‚Ä¢ Docker ‚Ä¢ –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (12 —Å–µ—Ä–≤–∏—Å–æ–≤)</small>
	</footer>
	
	<script>
	// –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
	{% if current_user.is_authenticated %}
	document.addEventListener('DOMContentLoaded', function() {
		fetch('/analytics/track', {
			method: 'POST',
			headers: {'Content-Type': 'application/json'},
			body: JSON.stringify({
				event_type: 'page_view',
				page: window.location.pathname
			})
		}).catch(err => console.log('Analytics error:', err));
	});
	{% endif %}
	</script>
</body>
</html>